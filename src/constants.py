"""
AV1 常量定义
按照规范文档定义的常量
"""

# OBU类型（规范文档 6.2.1）
OBU_RESERVED = 0
OBU_SEQUENCE_HEADER = 1
OBU_TEMPORAL_DELIMITER = 2
OBU_FRAME_HEADER = 3
OBU_TILE_GROUP = 4
OBU_METADATA = 5
OBU_FRAME = 6
OBU_REDUNDANT_FRAME_HEADER = 7
OBU_TILE_LIST = 8
OBU_PADDING = 15

# 帧类型（规范文档 6.8.2）
KEY_FRAME = 0
INTER_FRAME = 1
INTRA_ONLY_FRAME = 2
SWITCH_FRAME = 3

# 参考帧数量
NUM_REF_FRAMES = 8

# 平面类型
PLANE_Y = 0
PLANE_U = 1
PLANE_V = 2

# 块尺寸（规范文档定义）
BLOCK_4X4 = 0
BLOCK_4X8 = 1
BLOCK_8X4 = 2
BLOCK_8X8 = 3
BLOCK_8X16 = 4
BLOCK_16X8 = 5
BLOCK_16X16 = 6
BLOCK_16X32 = 7
BLOCK_32X16 = 8
BLOCK_32X32 = 9
BLOCK_32X64 = 10
BLOCK_64X32 = 11
BLOCK_64X64 = 12
BLOCK_64X128 = 13
BLOCK_128X64 = 14
BLOCK_128X128 = 15
BLOCK_INVALID = -1  # 无效块尺寸（用于Subsampled_Size查找表）

BLOCK_SIZES = 16  # 基础块尺寸数量

# 额外的块尺寸
BLOCK_4X16 = 16
BLOCK_16X4 = 17
BLOCK_8X32 = 18
BLOCK_32X8 = 19
BLOCK_16X64 = 20
BLOCK_64X16 = 21

BLOCK_SIZES_ALL = 22  # 所有块尺寸数量（包括额外尺寸）

# 划分模式（规范文档定义）
PARTITION_NONE = 0
PARTITION_HORZ = 1
PARTITION_VERT = 2
PARTITION_SPLIT = 3

# 其他常量
NUM_REF_FRAMES = 8
REFS_PER_FRAME = 3
FRAME_LF_COUNT = 4
WIENER_COEFFS = 3

# 参考帧类型（规范文档定义）
INTRA_FRAME = 0
LAST_FRAME = 1
LAST2_FRAME = 2
LAST3_FRAME = 3
GOLDEN_FRAME = 4
BWDREF_FRAME = 5
ALTREF2_FRAME = 6
ALTREF_FRAME = 7
NONE = -1  # 用于RefFrame[1]表示不存在的参考帧

# 帧内预测模式（规范文档定义）
INTRA_MODES = 13
DC_PRED = 0
V_PRED = 1
H_PRED = 2
D45_PRED = 3
D135_PRED = 4
D113_PRED = 5
D157_PRED = 6
D203_PRED = 7
D67_PRED = 8
SMOOTH_PRED = 9
SMOOTH_V_PRED = 10
SMOOTH_H_PRED = 11
PAETH_PRED = 12
PALETTE_MODE = 13  # Palette预测模式

# 运动模式（规范文档定义）
SIMPLE = 0
OBMC = 1
WARPED = 2

# Compound类型（规范文档定义）
COMPOUND_AVERAGE = 0
COMPOUND_WEDGE = 1
COMPOUND_DIFFWTD = 2

# 插值滤波器（规范文档定义）
EIGHTTAP = 0
EIGHTTAP_SMOOTH = 1
EIGHTTAP_SHARP = 2
BILINEAR = 3
SWITCHABLE = 4

# 帧间预测模式（规范文档定义）
NEARESTMV = 0
NEARMV = 1
NEWMV = 2
NEAREST_NEARESTMV = 3
NEAR_NEARMV = 4
NEAREST_NEWMV = 5
NEW_NEARESTMV = 6
NEAR_NEWMV = 7
NEW_NEARMV = 8
NEW_NEWMV = 9
GLOBALMV = 10
GLOBAL_GLOBALMV = 11

# Compound/Reference模式常量
SINGLE_REFERENCE = 0
COMPOUND_REFERENCE = 1
UNIDIR_COMP_REFERENCE = 0
BIDIR_COMP_REFERENCE = 1

# Segment级别常量
SEG_LVL_ALT_Q = 0
SEG_LVL_ALT_LF_Y_V = 1
SEG_LVL_ALT_LF_Y_H = 2
SEG_LVL_ALT_LF_U = 3
SEG_LVL_ALT_LF_V = 4
SEG_LVL_REF_FRAME = 5
SEG_LVL_SKIP = 6
SEG_LVL_GLOBALMV = 7

# 变换尺寸（规范文档定义）
TX_4X4 = 0
TX_8X8 = 1
TX_16X16 = 2
TX_32X32 = 3
TX_64X64 = 4
TX_4X8 = 5
TX_8X4 = 6
TX_8X16 = 7
TX_16X8 = 8
TX_16X32 = 9
TX_32X16 = 10
TX_32X64 = 11
TX_64X32 = 12
TX_4X16 = 13
TX_16X4 = 14
TX_8X32 = 15
TX_32X8 = 16
TX_16X64 = 17
TX_64X16 = 18

TX_SIZES = 5  # 方形变换尺寸数量
TX_SIZES_ALL = 19  # 所有变换尺寸数量

# 变换模式（规范文档定义）
TX_MODE_ONLY_4X4 = 0
TX_MODE_LARGEST = 1
TX_MODE_SELECT = 2

# 变换类型（规范文档定义）
DCT_DCT = 0
ADST_DCT = 1
DCT_ADST = 2
ADST_ADST = 3
IDTX = 4
V_DCT = 5
H_DCT = 6
V_ADST = 7
H_ADST = 8
V_FLIPADST = 9
H_FLIPADST = 10

# MI尺寸相关常量
MI_SIZE = 4
MI_SIZE_LOG2 = 2

# 系数解码相关常量（规范文档定义）
NUM_BASE_LEVELS = 2
COEFF_BASE_RANGE = 12
BR_CDF_SIZE = 4
SIG_COEF_CONTEXTS_EOB = 4
SIG_COEF_CONTEXTS_2D = 26
SIG_COEF_CONTEXTS = 42

# 块尺寸查找表（规范文档定义）
# Block_Width[BLOCK_SIZES_ALL] - 块宽度（以像素为单位）
Block_Width = [
    4, 4, 8, 8, 8, 16, 16, 16, 32, 32, 32, 64, 64, 64, 128, 128,  # 方形和矩形块
    4, 16, 8, 32, 16, 64  # 额外的矩形块
]

# Block_Height[BLOCK_SIZES_ALL] - 块高度（以像素为单位）
Block_Height = [
    4, 8, 4, 8, 16, 8, 16, 32, 16, 32, 64, 32, 64, 128, 64, 128,  # 方形和矩形块
    16, 4, 32, 8, 64, 16  # 额外的矩形块
]

# Num_4x4_Blocks_Wide[BLOCK_SIZES_ALL] - 块宽度（以4x4块为单位）
Num_4x4_Blocks_Wide = [
    1, 1, 2, 2, 2, 4, 4, 4, 8, 8, 8, 16, 16, 16, 32, 32,  # 方形和矩形块
    1, 4, 2, 8, 4, 16  # 额外的矩形块
]

# Num_4x4_Blocks_High[BLOCK_SIZES_ALL] - 块高度（以4x4块为单位）
Num_4x4_Blocks_High = [
    1, 2, 1, 2, 4, 2, 4, 8, 4, 8, 16, 8, 16, 32, 16, 32,  # 方形和矩形块
    4, 1, 8, 2, 16, 4  # 额外的矩形块
]

# Subsampled_Size查找表（规范文档定义）
# Subsampled_Size[BLOCK_SIZES][subx][suby]
# subx和suby可以是0或1（表示subsampling_x和subsampling_y）
Subsampled_Size = [
    # BLOCK_4X4 (0)
    [[BLOCK_4X4, BLOCK_4X4], [BLOCK_4X4, BLOCK_4X4]],
    # BLOCK_4X8 (1)
    [[BLOCK_4X8, BLOCK_4X4], [BLOCK_INVALID, BLOCK_4X4]],
    # BLOCK_8X4 (2)
    [[BLOCK_8X4, BLOCK_INVALID], [BLOCK_4X4, BLOCK_4X4]],
    # BLOCK_8X8 (3)
    [[BLOCK_8X8, BLOCK_8X4], [BLOCK_4X8, BLOCK_4X4]],
    # BLOCK_8X16 (4)
    [[BLOCK_8X16, BLOCK_8X8], [BLOCK_INVALID, BLOCK_4X8]],
    # BLOCK_16X8 (5)
    [[BLOCK_16X8, BLOCK_INVALID], [BLOCK_8X8, BLOCK_8X4]],
    # BLOCK_16X16 (6)
    [[BLOCK_16X16, BLOCK_16X8], [BLOCK_8X16, BLOCK_8X8]],
    # BLOCK_16X32 (7)
    [[BLOCK_16X32, BLOCK_16X16], [BLOCK_INVALID, BLOCK_8X16]],
    # BLOCK_32X16 (8)
    [[BLOCK_32X16, BLOCK_INVALID], [BLOCK_16X16, BLOCK_16X8]],
    # BLOCK_32X32 (9)
    [[BLOCK_32X32, BLOCK_32X16], [BLOCK_16X32, BLOCK_16X16]],
    # BLOCK_32X64 (10)
    [[BLOCK_32X64, BLOCK_32X32], [BLOCK_INVALID, BLOCK_16X32]],
    # BLOCK_64X32 (11)
    [[BLOCK_64X32, BLOCK_INVALID], [BLOCK_32X32, BLOCK_32X16]],
    # BLOCK_64X64 (12)
    [[BLOCK_64X64, BLOCK_64X32], [BLOCK_32X64, BLOCK_32X32]],
    # BLOCK_64X128 (13)
    [[BLOCK_64X128, BLOCK_64X64], [BLOCK_INVALID, BLOCK_32X64]],
    # BLOCK_128X64 (14)
    [[BLOCK_128X64, BLOCK_INVALID], [BLOCK_64X64, BLOCK_64X32]],
    # BLOCK_128X128 (15)
    [[BLOCK_128X128, BLOCK_128X64], [BLOCK_64X128, BLOCK_64X64]],
    # BLOCK_4X16 (16)
    [[BLOCK_4X16, BLOCK_4X8], [BLOCK_INVALID, BLOCK_4X8]],
    # BLOCK_16X4 (17)
    [[BLOCK_16X4, BLOCK_INVALID], [BLOCK_8X4, BLOCK_8X4]],
    # BLOCK_8X32 (18)
    [[BLOCK_8X32, BLOCK_8X16], [BLOCK_INVALID, BLOCK_4X16]],
    # BLOCK_32X8 (19)
    [[BLOCK_32X8, BLOCK_INVALID], [BLOCK_16X8, BLOCK_16X4]],
    # BLOCK_16X64 (20)
    [[BLOCK_16X64, BLOCK_16X32], [BLOCK_INVALID, BLOCK_8X32]],
    # BLOCK_64X16 (21)
    [[BLOCK_64X16, BLOCK_INVALID], [BLOCK_32X16, BLOCK_32X8]],
]

